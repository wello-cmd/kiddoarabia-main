const o={},d={LCP:{good:1200,poor:2500},FID:{good:10,poor:100},INP:{good:10,poor:200},CLS:{good:.01,poor:.25},FCP:{good:800,poor:1800},TTFB:{good:100,poor:600}},i=(t,r)=>{const a=d[t];return!a||r<=a.good?"good":r<=a.poor?"needs-improvement":"poor"},s=t=>{typeof window<"u"&&window.gtag&&window.gtag("event",t.name,{event_category:"Web Vitals",value:Math.round(t.value),metric_rating:t.rating,custom_parameter_name:"web_vitals"}),fetch("/api/analytics/web-vitals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).catch(()=>{})},c=()=>{if(!(typeof window>"u"||!("PerformanceObserver"in window))){try{new PerformanceObserver(r=>{const a=r.getEntries(),n=a[a.length-1],e=Math.round(n.renderTime||n.loadTime);o.lcp=e,s({name:"LCP",value:e,rating:i("LCP",e),delta:e-(o.lcp||0),id:n.id||"lcp"})}).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver(r=>{r.getEntries().forEach(n=>{const e=Math.round(n.processingStart-n.startTime);o.fid=e,s({name:"FID",value:e,rating:i("FID",e),delta:e-(o.fid||0),id:n.id||"fid"})})}).observe({entryTypes:["first-input"]}),new PerformanceObserver(r=>{r.getEntries().forEach(n=>{if(n.interactionId){const e=Math.round(n.processingEnd-n.startTime);o.inp=e,s({name:"INP",value:e,rating:i("INP",e),delta:e-(o.inp||0),id:n.id||"inp"})}})}).observe({entryTypes:["event"]});let t=0;new PerformanceObserver(r=>{r.getEntries().forEach(n=>{n.hadRecentInput||(t+=n.value)}),o.cls=t,s({name:"CLS",value:Math.round(t*1e3)/1e3,rating:i("CLS",t),delta:t-(o.cls||0),id:"cls"})}).observe({entryTypes:["layout-shift"]}),new PerformanceObserver(r=>{r.getEntries().forEach(n=>{const e=Math.round(n.startTime);o.fcp=e,s({name:"FCP",value:e,rating:i("FCP",e),delta:e-(o.fcp||0),id:n.id||"fcp"})})}).observe({entryTypes:["paint"]})}catch(t){console.warn("Web Vitals measurement failed:",t)}window.addEventListener("load",()=>{const t=performance.getEntriesByType("navigation")[0];if(t){const r=Math.round(t.responseStart-t.requestStart);o.ttfb=r,s({name:"TTFB",value:r,rating:i("TTFB",r),delta:r-(o.ttfb||0),id:"ttfb"})}})}};export{c as measureWebVitals};
